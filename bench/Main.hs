{-# LANGUAGE DeriveGeneric #-}
import           Criterion.Main
import           Data.Functor.Identity
import qualified Data.Generic.HKD as Hig
import           GHC.Generics
import           HiFi

main :: IO ()
main = defaultMain
  [ bench "fromRecord (hi-fi)" $ whnf fromRecordHiFi testRec
  , bench "fromRecord (higgledy)" $ whnf fromRecordHiggledy testRec
  ]

fromRecordHiFi :: Test -> HKD Test Identity
fromRecordHiFi = fromRecord

fromRecordHiggledy :: Test -> Hig.HKD Test Identity
fromRecordHiggledy = Hig.deconstruct

testRec :: Test
testRec = Test
  { t1 = 123
  , t2 = 123
  , t3 = 123
  , t4 = 123
  , t5 = 123
  , t6 = 123
  , t7 = 123
  , t8 = 123
  , t9 = 123
  , t10 = 123
  , t11 = 123
  , t12 = 123
  , t13 = 123
  , t14 = 123
  , t15 = 123
  , t16 = 123
  , t17 = 123
  , t18 = 123
  , t19 = 123
  , t20 = 123
  , t21 = 123
  , t22 = 123
  , t23 = 123
  , t24 = 123
  , t25 = 123
  , t26 = 123
  , t27 = 123
  , t28 = 123
  , t29 = 123
  , t30 = 123
  , t31 = 123
  , t32 = 123
  , t33 = 123
  , t34 = 123
  , t35 = 123
  , t36 = 123
  , t37 = 123
  , t38 = 123
  , t39 = 123
  , t40 = 123
  , t41 = 123
  , t42 = 123
  , t43 = 123
  , t44 = 123
  , t45 = 123
  , t46 = 123
  , t47 = 123
  , t48 = 123
  , t49 = 123
  , t50 = 123
  , t51 = 123
  , t52 = 123
  , t53 = 123
  , t54 = 123
  , t55 = 123
  , t56 = 123
  , t57 = 123
  , t58 = 123
  , t59 = 123
  , t60 = 123
  , t61 = 123
  , t62 = 123
  , t63 = 123
  , t64 = 123
  , t65 = 123
  , t66 = 123
  , t67 = 123
  , t68 = 123
  , t69 = 123
  , t70 = 123
  , t71 = 123
  , t72 = 123
  , t73 = 123
  , t74 = 123
  , t75 = 123
  , t76 = 123
  , t77 = 123
  , t78 = 123
  , t79 = 123
  , t80 = 123
  , t81 = 123
  , t82 = 123
  , t83 = 123
  , t84 = 123
  , t85 = 123
  , t86 = 123
  , t87 = 123
  , t88 = 123
  , t89 = 123
  , t90 = 123
  , t91 = 123
  , t92 = 123
  , t93 = 123
  , t94 = 123
  , t95 = 123
  , t96 = 123
  , t97 = 123
  , t98 = 123
  , t99 = 123
  , t100 = 123
  , t101 = 123
  , t102 = 123
  , t103 = 123
  , t104 = 123
  , t105 = 123
  , t106 = 123
  , t107 = 123
  , t108 = 123
  , t109 = 123
  , t110 = 123
  , t111 = 123
  , t112 = 123
  , t113 = 123
  , t114 = 123
  , t115 = 123
  , t116 = 123
  , t117 = 123
  , t118 = 123
  , t119 = 123
  , t120 = 123
  , t121 = 123
  , t122 = 123
  , t123 = 123
  , t124 = 123
  , t125 = 123
  , t126 = 123
  , t127 = 123
  , t128 = 123
  , t129 = 123
  , t130 = 123
  , t131 = 123
  , t132 = 123
  , t133 = 123
  , t134 = 123
  , t135 = 123
  , t136 = 123
  , t137 = 123
  , t138 = 123
  , t139 = 123
  , t140 = 123
  , t141 = 123
  , t142 = 123
  , t143 = 123
  , t144 = 123
  , t145 = 123
  , t146 = 123
  , t147 = 123
  , t148 = 123
  , t149 = 123
  , t150 = 123
  , t151 = 123
  , t152 = 123
  , t153 = 123
  , t154 = 123
  , t155 = 123
  , t156 = 123
  , t157 = 123
  , t158 = 123
  , t159 = 123
  , t160 = 123
  , t161 = 123
  , t162 = 123
  , t163 = 123
  , t164 = 123
  , t165 = 123
  , t166 = 123
  , t167 = 123
  , t168 = 123
  , t169 = 123
  , t170 = 123
  , t171 = 123
  , t172 = 123
  , t173 = 123
  , t174 = 123
  , t175 = 123
  , t176 = 123
  , t177 = 123
  , t178 = 123
  , t179 = 123
  , t180 = 123
  , t181 = 123
  , t182 = 123
  , t183 = 123
  , t184 = 123
  , t185 = 123
  , t186 = 123
  , t187 = 123
  , t188 = 123
  , t189 = 123
  , t190 = 123
  , t191 = 123
  , t192 = 123
  , t193 = 123
  , t194 = 123
  , t195 = 123
  , t196 = 123
  , t197 = 123
  , t198 = 123
  , t199 = 123
  , t200 = 123
  , t201 = 123
  , t202 = 123
  , t203 = 123
  , t204 = 123
  , t205 = 123
  , t206 = 123
  , t207 = 123
  , t208 = 123
  , t209 = 123
  , t210 = 123
  , t211 = 123
  , t212 = 123
  , t213 = 123
  , t214 = 123
  , t215 = 123
  , t216 = 123
  , t217 = 123
  , t218 = 123
  , t219 = 123
  , t220 = 123
  , t221 = 123
  , t222 = 123
  , t223 = 123
  , t224 = 123
  , t225 = 123
  , t226 = 123
  , t227 = 123
  , t228 = 123
  , t229 = 123
  , t230 = 123
  , t231 = 123
  , t232 = 123
  , t233 = 123
  , t234 = 123
  , t235 = 123
  , t236 = 123
  , t237 = 123
  , t238 = 123
  , t239 = 123
  , t240 = 123
  , t241 = 123
  , t242 = 123
  , t243 = 123
  , t244 = 123
  , t245 = 123
  , t246 = 123
  , t247 = 123
  , t248 = 123
  , t249 = 123
  , t250 = 123
  , t251 = 123
  , t252 = 123
  , t253 = 123
  , t254 = 123
  , t255 = 123
  , t256 = 123
  , t257 = 123
  , t258 = 123
  , t259 = 123
  , t260 = 123
  , t261 = 123
  , t262 = 123
  , t263 = 123
  , t264 = 123
  , t265 = 123
  , t266 = 123
  , t267 = 123
  , t268 = 123
  , t269 = 123
  , t270 = 123
  , t271 = 123
  , t272 = 123
  , t273 = 123
  , t274 = 123
  , t275 = 123
  , t276 = 123
  , t277 = 123
  , t278 = 123
  , t279 = 123
  , t280 = 123
  , t281 = 123
  , t282 = 123
  , t283 = 123
  , t284 = 123
  , t285 = 123
  , t286 = 123
  , t287 = 123
  , t288 = 123
  , t289 = 123
  , t290 = 123
  , t291 = 123
  , t292 = 123
  , t293 = 123
  , t294 = 123
  , t295 = 123
  , t296 = 123
  , t297 = 123
  , t298 = 123
  , t299 = 123
  , t300 = 123
  , t301 = 123
  , t302 = 123
  , t303 = 123
  , t304 = 123
  , t305 = 123
  , t306 = 123
  , t307 = 123
  , t308 = 123
  , t309 = 123
  , t310 = 123
  , t311 = 123
  , t312 = 123
  , t313 = 123
  , t314 = 123
  , t315 = 123
  , t316 = 123
  , t317 = 123
  , t318 = 123
  , t319 = 123
  , t320 = 123
  , t321 = 123
  , t322 = 123
  , t323 = 123
  , t324 = 123
  , t325 = 123
  , t326 = 123
  , t327 = 123
  , t328 = 123
  , t329 = 123
  , t330 = 123
  , t331 = 123
  , t332 = 123
  , t333 = 123
  , t334 = 123
  , t335 = 123
  , t336 = 123
  , t337 = 123
  , t338 = 123
  , t339 = 123
  , t340 = 123
  , t341 = 123
  , t342 = 123
  , t343 = 123
  , t344 = 123
  , t345 = 123
  , t346 = 123
  , t347 = 123
  , t348 = 123
  , t349 = 123
  , t350 = 123
  , t351 = 123
  , t352 = 123
  , t353 = 123
  , t354 = 123
  , t355 = 123
  , t356 = 123
  , t357 = 123
  , t358 = 123
  , t359 = 123
  , t360 = 123
  , t361 = 123
  , t362 = 123
  , t363 = 123
  , t364 = 123
  , t365 = 123
  , t366 = 123
  , t367 = 123
  , t368 = 123
  , t369 = 123
  , t370 = 123
  , t371 = 123
  , t372 = 123
  , t373 = 123
  , t374 = 123
  , t375 = 123
  , t376 = 123
  , t377 = 123
  , t378 = 123
  , t379 = 123
  , t380 = 123
  , t381 = 123
  , t382 = 123
  , t383 = 123
  , t384 = 123
  , t385 = 123
  , t386 = 123
  , t387 = 123
  , t388 = 123
  , t389 = 123
  , t390 = 123
  , t391 = 123
  , t392 = 123
  , t393 = 123
  , t394 = 123
  , t395 = 123
  , t396 = 123
  , t397 = 123
  , t398 = 123
  , t399 = 123
  , t400 = 123
  }

data Test = Test
  { t1 :: Int
  , t2 :: Int
  , t3 :: Int
  , t4 :: Int
  , t5 :: Int
  , t6 :: Int
  , t7 :: Int
  , t8 :: Int
  , t9 :: Int
  , t10 :: Int
  , t11 :: Int
  , t12 :: Int
  , t13 :: Int
  , t14 :: Int
  , t15 :: Int
  , t16 :: Int
  , t17 :: Int
  , t18 :: Int
  , t19 :: Int
  , t20 :: Int
  , t21 :: Int
  , t22 :: Int
  , t23 :: Int
  , t24 :: Int
  , t25 :: Int
  , t26 :: Int
  , t27 :: Int
  , t28 :: Int
  , t29 :: Int
  , t30 :: Int
  , t31 :: Int
  , t32 :: Int
  , t33 :: Int
  , t34 :: Int
  , t35 :: Int
  , t36 :: Int
  , t37 :: Int
  , t38 :: Int
  , t39 :: Int
  , t40 :: Int
  , t41 :: Int
  , t42 :: Int
  , t43 :: Int
  , t44 :: Int
  , t45 :: Int
  , t46 :: Int
  , t47 :: Int
  , t48 :: Int
  , t49 :: Int
  , t50 :: Int
  , t51 :: Int
  , t52 :: Int
  , t53 :: Int
  , t54 :: Int
  , t55 :: Int
  , t56 :: Int
  , t57 :: Int
  , t58 :: Int
  , t59 :: Int
  , t60 :: Int
  , t61 :: Int
  , t62 :: Int
  , t63 :: Int
  , t64 :: Int
  , t65 :: Int
  , t66 :: Int
  , t67 :: Int
  , t68 :: Int
  , t69 :: Int
  , t70 :: Int
  , t71 :: Int
  , t72 :: Int
  , t73 :: Int
  , t74 :: Int
  , t75 :: Int
  , t76 :: Int
  , t77 :: Int
  , t78 :: Int
  , t79 :: Int
  , t80 :: Int
  , t81 :: Int
  , t82 :: Int
  , t83 :: Int
  , t84 :: Int
  , t85 :: Int
  , t86 :: Int
  , t87 :: Int
  , t88 :: Int
  , t89 :: Int
  , t90 :: Int
  , t91 :: Int
  , t92 :: Int
  , t93 :: Int
  , t94 :: Int
  , t95 :: Int
  , t96 :: Int
  , t97 :: Int
  , t98 :: Int
  , t99 :: Int
  , t100 :: Int
  , t101 :: Int
  , t102 :: Int
  , t103 :: Int
  , t104 :: Int
  , t105 :: Int
  , t106 :: Int
  , t107 :: Int
  , t108 :: Int
  , t109 :: Int
  , t110 :: Int
  , t111 :: Int
  , t112 :: Int
  , t113 :: Int
  , t114 :: Int
  , t115 :: Int
  , t116 :: Int
  , t117 :: Int
  , t118 :: Int
  , t119 :: Int
  , t120 :: Int
  , t121 :: Int
  , t122 :: Int
  , t123 :: Int
  , t124 :: Int
  , t125 :: Int
  , t126 :: Int
  , t127 :: Int
  , t128 :: Int
  , t129 :: Int
  , t130 :: Int
  , t131 :: Int
  , t132 :: Int
  , t133 :: Int
  , t134 :: Int
  , t135 :: Int
  , t136 :: Int
  , t137 :: Int
  , t138 :: Int
  , t139 :: Int
  , t140 :: Int
  , t141 :: Int
  , t142 :: Int
  , t143 :: Int
  , t144 :: Int
  , t145 :: Int
  , t146 :: Int
  , t147 :: Int
  , t148 :: Int
  , t149 :: Int
  , t150 :: Int
  , t151 :: Int
  , t152 :: Int
  , t153 :: Int
  , t154 :: Int
  , t155 :: Int
  , t156 :: Int
  , t157 :: Int
  , t158 :: Int
  , t159 :: Int
  , t160 :: Int
  , t161 :: Int
  , t162 :: Int
  , t163 :: Int
  , t164 :: Int
  , t165 :: Int
  , t166 :: Int
  , t167 :: Int
  , t168 :: Int
  , t169 :: Int
  , t170 :: Int
  , t171 :: Int
  , t172 :: Int
  , t173 :: Int
  , t174 :: Int
  , t175 :: Int
  , t176 :: Int
  , t177 :: Int
  , t178 :: Int
  , t179 :: Int
  , t180 :: Int
  , t181 :: Int
  , t182 :: Int
  , t183 :: Int
  , t184 :: Int
  , t185 :: Int
  , t186 :: Int
  , t187 :: Int
  , t188 :: Int
  , t189 :: Int
  , t190 :: Int
  , t191 :: Int
  , t192 :: Int
  , t193 :: Int
  , t194 :: Int
  , t195 :: Int
  , t196 :: Int
  , t197 :: Int
  , t198 :: Int
  , t199 :: Int
  , t200 :: Int
  , t201 :: Int
  , t202 :: Int
  , t203 :: Int
  , t204 :: Int
  , t205 :: Int
  , t206 :: Int
  , t207 :: Int
  , t208 :: Int
  , t209 :: Int
  , t210 :: Int
  , t211 :: Int
  , t212 :: Int
  , t213 :: Int
  , t214 :: Int
  , t215 :: Int
  , t216 :: Int
  , t217 :: Int
  , t218 :: Int
  , t219 :: Int
  , t220 :: Int
  , t221 :: Int
  , t222 :: Int
  , t223 :: Int
  , t224 :: Int
  , t225 :: Int
  , t226 :: Int
  , t227 :: Int
  , t228 :: Int
  , t229 :: Int
  , t230 :: Int
  , t231 :: Int
  , t232 :: Int
  , t233 :: Int
  , t234 :: Int
  , t235 :: Int
  , t236 :: Int
  , t237 :: Int
  , t238 :: Int
  , t239 :: Int
  , t240 :: Int
  , t241 :: Int
  , t242 :: Int
  , t243 :: Int
  , t244 :: Int
  , t245 :: Int
  , t246 :: Int
  , t247 :: Int
  , t248 :: Int
  , t249 :: Int
  , t250 :: Int
  , t251 :: Int
  , t252 :: Int
  , t253 :: Int
  , t254 :: Int
  , t255 :: Int
  , t256 :: Int
  , t257 :: Int
  , t258 :: Int
  , t259 :: Int
  , t260 :: Int
  , t261 :: Int
  , t262 :: Int
  , t263 :: Int
  , t264 :: Int
  , t265 :: Int
  , t266 :: Int
  , t267 :: Int
  , t268 :: Int
  , t269 :: Int
  , t270 :: Int
  , t271 :: Int
  , t272 :: Int
  , t273 :: Int
  , t274 :: Int
  , t275 :: Int
  , t276 :: Int
  , t277 :: Int
  , t278 :: Int
  , t279 :: Int
  , t280 :: Int
  , t281 :: Int
  , t282 :: Int
  , t283 :: Int
  , t284 :: Int
  , t285 :: Int
  , t286 :: Int
  , t287 :: Int
  , t288 :: Int
  , t289 :: Int
  , t290 :: Int
  , t291 :: Int
  , t292 :: Int
  , t293 :: Int
  , t294 :: Int
  , t295 :: Int
  , t296 :: Int
  , t297 :: Int
  , t298 :: Int
  , t299 :: Int
  , t300 :: Int
  , t301 :: Int
  , t302 :: Int
  , t303 :: Int
  , t304 :: Int
  , t305 :: Int
  , t306 :: Int
  , t307 :: Int
  , t308 :: Int
  , t309 :: Int
  , t310 :: Int
  , t311 :: Int
  , t312 :: Int
  , t313 :: Int
  , t314 :: Int
  , t315 :: Int
  , t316 :: Int
  , t317 :: Int
  , t318 :: Int
  , t319 :: Int
  , t320 :: Int
  , t321 :: Int
  , t322 :: Int
  , t323 :: Int
  , t324 :: Int
  , t325 :: Int
  , t326 :: Int
  , t327 :: Int
  , t328 :: Int
  , t329 :: Int
  , t330 :: Int
  , t331 :: Int
  , t332 :: Int
  , t333 :: Int
  , t334 :: Int
  , t335 :: Int
  , t336 :: Int
  , t337 :: Int
  , t338 :: Int
  , t339 :: Int
  , t340 :: Int
  , t341 :: Int
  , t342 :: Int
  , t343 :: Int
  , t344 :: Int
  , t345 :: Int
  , t346 :: Int
  , t347 :: Int
  , t348 :: Int
  , t349 :: Int
  , t350 :: Int
  , t351 :: Int
  , t352 :: Int
  , t353 :: Int
  , t354 :: Int
  , t355 :: Int
  , t356 :: Int
  , t357 :: Int
  , t358 :: Int
  , t359 :: Int
  , t360 :: Int
  , t361 :: Int
  , t362 :: Int
  , t363 :: Int
  , t364 :: Int
  , t365 :: Int
  , t366 :: Int
  , t367 :: Int
  , t368 :: Int
  , t369 :: Int
  , t370 :: Int
  , t371 :: Int
  , t372 :: Int
  , t373 :: Int
  , t374 :: Int
  , t375 :: Int
  , t376 :: Int
  , t377 :: Int
  , t378 :: Int
  , t379 :: Int
  , t380 :: Int
  , t381 :: Int
  , t382 :: Int
  , t383 :: Int
  , t384 :: Int
  , t385 :: Int
  , t386 :: Int
  , t387 :: Int
  , t388 :: Int
  , t389 :: Int
  , t390 :: Int
  , t391 :: Int
  , t392 :: Int
  , t393 :: Int
  , t394 :: Int
  , t395 :: Int
  , t396 :: Int
  , t397 :: Int
  , t398 :: Int
  , t399 :: Int
  , t400 :: Int
  } deriving Generic
